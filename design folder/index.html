<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tic-Tac-Toe</title>
    <link rel="stylesheet" href="style.css">
</head>
<body background="background html.jpg">
    <img src="devider hollow.png" id="divider" alt="Divider">
    <h1>Tic-Tac-Toe</h1>
    <img src="devid hollow 3.png" id="divider-bottom" alt="Bottom Divider"> 
    <div id="userOppContainer">
        <p id="userCont">the knight: <span id="user"></span></p>
        <p id="oppNameCont">the enemy: <span id="oppName"></span></p>
    </div>
    <br>
    <p id="valueCont">You are fighting as <span id="value"></span></p>
    <br>
    <p id="whosTrn">X's Turn</p>
    <div>
        <p id="entreName">Enter your Name: </p>
        <input type="text" placeholder="Name" id="name" autocomplete="off">
    </div>
    <button id="find">Search for a fighter</button>
    <img src="loading.gif.gif" id="loading" alt="loading">
    <div id="bigCont">
        <div id="cont">
            <button id="btn1" class="btn"></button>
            <button id="btn2" class="btn"></button>
            <button id="btn3" class="btn"></button>
            <button id="btn4" class="btn"></button>
            <button id="btn5" class="btn"></button>
            <button id="btn6" class="btn"></button>
            <button id="btn7" class="btn"></button>
            <button id="btn8" class="btn"></button>
            <button id="btn9" class="btn"></button>
        </div>
    </div>
</body>
<scriptsrc="/socket.io/socket.io.js">*
    <script> document.getElementById("loading").style.display="none"
        document.getElementById("bigCont").style.display="none"
        document.getElementById("userCont").style.display="none"
        document.getElementById("oppNameCont").style.display="none"
        document.getElementById("valueCont").style.display="none"
        document.getElementById("whosTurn").style.display="none"

        const socket=io();
        let name;
        document.getElementById("find").addEventListener("click",function(){
            name=document.getElementById("name").value

            document.getAnimations("user").innerText=name

            if(name==null || name=='') { 
                alert("entre a name")
            }
            
            else{
                socket.emit("find",{name:name})

                document.getElementById("loading").style.display="block"
                document.getElementById("find").disabled=true
            }
        })

        socket.on("find",(e)=>{

           let allplayersArray=e.allplayers

           console.log(allplayersArray)

           document.getElementById("userCont").style.display="block"
           document.getElementById("oppNameCont").style.display="block"
           document.getElementById("valueCont").style.display="block"
           document.getElementById("loading").style.display="none"
           document.getElementById("name").style.display="none"
           document.getElementById("find").style.display="none"
           document.getElementById("enterName").style.display="none"
           document.getElementById("bigcont").style.display="block"
           document.getElementById("whosTurn").style.display="block"
           document.getElementById("whosTurn").style.display="X's Turn"
           let oppName
           let value

           const foundObj=allplayersArray.find(obj=>obj.p1.p1name=='${name}' || obj.p2.p2name== '${name}')
           foundObj.p1.p1name== '${name}' ? oppName=foundObj.p2.p2name : oppName=foundObj.p1.p1name
           foundObj.p1.p1name== '${name}' ? value=foundObj.p2.p2value : oppvalue=foundObj.p1.p1value

           document.getElementById("opp").innerText=oppName
           document.getElementById("value").innerText=value
        })
       

    </script>